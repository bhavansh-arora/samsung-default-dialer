{"version":3,"sources":["./src/app/incall/incall-routing.module.ts","./src/app/incall/incall.module.ts","./src/app/incall/incall.page.ts","./src/app/incall/incall.page.scss","./src/app/incall/incall.page.html"],"names":[],"mappings":"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","file":"src_app_incall_incall_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IncallPage } from './incall.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: IncallPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class IncallPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { IncallPageRoutingModule } from './incall-routing.module';\n\nimport { IncallPage } from './incall.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    IncallPageRoutingModule\n  ],\n  declarations: [IncallPage]\n})\nexport class IncallPageModule {}\n","import {Component, NgZone, OnDestroy, OnInit} from '@angular/core';\nimport {PhoneService} from '../services/phone.service';\nimport {PhoneCallStatusModel} from '../services/phone-call-status.model';\nimport {Subscription} from 'rxjs';\n\n@Component({\n  selector: 'app-incall',\n  templateUrl: './incall.page.html',\n  styleUrls: ['./incall.page.scss'],\n})\nexport class IncallPage implements OnInit, OnDestroy {\n  public isMicrophoneMuted = true;\n  public callStatusText = '';\n\n  private callStatusSubscription: Subscription;\n  private currentCallStatus: PhoneCallStatusModel;\n  private callDurationInterval = 0;\n  private callDurationCounter = 0;\n\n  constructor(private phoneService: PhoneService, private ngZone: NgZone) { }\n\n  get canEndCall() {\n    return this.currentCallStatus === PhoneCallStatusModel.ACTIVE ||\n      this.currentCallStatus === PhoneCallStatusModel.DIALING;\n  }\n\n  ngOnInit() {\n    this.callStatusSubscription = this.phoneService.currentCallStatus.subscribe(status => {\n      this.ngZone.run(args => {\n        this.updateCallStatus(status);\n      });\n    });\n    this.phoneService.isMicrophoneMuted().then(value => {\n      this.isMicrophoneMuted = value;\n    }).catch(reason => {\n      console.error('error when getting isMicrophoneMuted:\\n', reason);\n    });\n  }\n\n  ngOnDestroy() {\n    if (this.callDurationInterval !== 0) {\n      window.clearInterval(this.callDurationInterval);\n    }\n    this.callStatusSubscription?.unsubscribe();\n  }\n\n  async handleToggleMicrophone() {\n    try {\n      await this.phoneService.setMicrophone(this.isMicrophoneMuted ? 'on' : 'off');\n      this.isMicrophoneMuted = !this.isMicrophoneMuted;\n    } catch (e) {\n      console.error('Error when setting microphone mute:\\n', e);\n    }\n  }\n\n  async handleTouchConfirmEndCall() {\n    if (!this.canEndCall) {\n      console.log('Cannot end call!');\n    }\n    else {\n      console.log('Try to end call...');\n      await this.phoneService.endCall();\n    }\n  }\n\n  private updateCallStatus(status: PhoneCallStatusModel) {\n    this.currentCallStatus = status;\n    switch (status) {\n      case PhoneCallStatusModel.UNKNOWN:\n        // TODO: Unknown error or status raised :|\n        break;\n      case PhoneCallStatusModel.CONNECTING:\n        console.log('New call status: Connecting!');\n        break;\n      case PhoneCallStatusModel.DIALING:\n        console.log('New call status: Dialing!');\n        break;\n      case PhoneCallStatusModel.ACTIVE:\n        console.log('New call status: Active!');\n        const startTime = Date.now() - (this.callDurationCounter);\n        if (this.callDurationInterval !== 0)\n          {break;}\n        this.callDurationInterval = window.setInterval(() => {\n          this.callStatusText = `Call Duration: ${(Date.now() - startTime) / 1000}`;\n        }, 1000);\n\n        break;\n      case PhoneCallStatusModel.DISCONNECTED:\n        console.log('New call status: Disconnected!');\n        this.callStatusText = '';\n        break;\n    }\n  }\n\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJpbmNhbGwucGFnZS5zY3NzIn0= */\";","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>incall</ion-title>\\n\\n    <ion-button (click)=\\\"handleTouchConfirmEndCall()\\\">End call</ion-button>\\n    <ion-button (click)=\\\"handleToggleMicrophone()\\\">{{isMicrophoneMuted ? 'Mute' : 'Unmute'}} microphone</ion-button>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <a>{{callStatusText}}</a>\\n</ion-content>\\n\";"],"sourceRoot":"webpack:///"}